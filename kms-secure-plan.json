{
  "format_version": "1.2",
  "terraform_version": "1.5.7",
  "resource_changes": [
    {
      "address": "aws_kms_key.this",
      "mode": "managed",
      "type": "aws_kms_key",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "description": "Secure KMS key for encryption",
          "deletion_window_in_days": 30,
          "enable_key_rotation": true,
          "policy": "{\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"Enable IAM User Permissions\",\"Effect\":\"Allow\",\"Principal\":{\"AWS\":\"arn:aws:iam::123456789012:root\"},\"Action\":\"kms:*\",\"Resource\":\"*\"},{\"Sid\":\"Allow CloudTrail to encrypt logs\",\"Effect\":\"Allow\",\"Principal\":{\"Service\":\"cloudtrail.amazonaws.com\"},\"Action\":[\"kms:GenerateDataKey*\"],\"Resource\":\"*\",\"Condition\":{\"StringEquals\":{\"kms:EncryptionContext:aws:cloudtrail:arn\":\"arn:aws:cloudtrail:us-east-1:123456789012:trail/secure-trail\"}}}]}",
          "tags": {
            "Name": "secure-kms-key",
            "Purpose": "secure-encryption"
          }
        }
      }
    },
    {
      "address": "aws_kms_alias.this",
      "mode": "managed",
      "type": "aws_kms_alias",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "name": "alias/secure-kms-key",
          "target_key_id": "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012"
        }
      }
    },
    {
      "address": "aws_cloudwatch_log_group.this",
      "mode": "managed",
      "type": "aws_cloudwatch_log_group",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "name": "/aws/kms/secure-kms-key",
          "retention_in_days": 90,
          "tags": {
            "Name": "secure-kms-log-group"
          }
        }
      }
    }
  ]
}
