{
  "format_version": "1.2",
  "terraform_version": "1.5.7",
  "resource_changes": [
    {
      "address": "aws_s3_bucket.this",
      "mode": "managed",
      "type": "aws_s3_bucket",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "force_destroy": false,
          "tags": {
            "Name": "test-secure-bucket-1234567890",
            "Purpose": "secure-storage"
          }
        }
      }
    },
    {
      "address": "aws_s3_bucket_server_side_encryption_configuration.this",
      "mode": "managed",
      "type": "aws_s3_bucket_server_side_encryption_configuration",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "rule": [
            {
              "apply_server_side_encryption_by_default": {
                "kms_master_key_id": "arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012",
                "sse_algorithm": "aws:kms"
              },
              "bucket_key_enabled": true
            }
          ]
        }
      }
    },
    {
      "address": "aws_s3_bucket_public_access_block.this",
      "mode": "managed",
      "type": "aws_s3_bucket_public_access_block",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "block_public_acls": true,
          "block_public_policy": true,
          "ignore_public_acls": true,
          "restrict_public_buckets": true
        }
      }
    },
    {
      "address": "aws_s3_bucket_ownership_controls.this",
      "mode": "managed",
      "type": "aws_s3_bucket_ownership_controls",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "rule": [
            {
              "object_ownership": "BucketOwnerEnforced"
            }
          ]
        }
      }
    },
    {
      "address": "aws_s3_bucket_versioning.this",
      "mode": "managed",
      "type": "aws_s3_bucket_versioning",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "versioning_configuration": {
            "status": "Enabled"
          }
        }
      }
    },
    {
      "address": "aws_s3_bucket_logging.this",
      "mode": "managed",
      "type": "aws_s3_bucket_logging",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "target_bucket": "test-secure-logs-1234567890",
          "target_prefix": "logs/"
        }
      }
    },
    {
      "address": "aws_s3_bucket_policy.this",
      "mode": "managed",
      "type": "aws_s3_bucket_policy",
      "name": "this",
      "provider_name": "aws",
      "change": {
        "actions": ["create"],
        "after": {
          "bucket": "test-secure-bucket-1234567890",
          "policy": {
            "Version": "2012-10-17",
            "Statement": [
              {
                "Sid": "DenyInsecureTransport",
                "Effect": "Deny",
                "Principal": "*",
                "Action": "s3:*",
                "Resource": [
                  "arn:aws:s3:::test-secure-bucket-1234567890",
                  "arn:aws:s3:::test-secure-bucket-1234567890/*"
                ],
                "Condition": {
                  "Bool": {
                    "aws:SecureTransport": "false"
                  }
                }
              },
              {
                "Sid": "DenyUnEncryptedObjectUploads",
                "Effect": "Deny",
                "Principal": "*",
                "Action": [
                  "s3:PutObject",
                  "s3:PutObjectAcl",
                  "s3:InitiateMultipartUpload"
                ],
                "Resource": "arn:aws:s3:::test-secure-bucket-1234567890/*",
                "Condition": {
                  "StringNotEqualsIfExists": {
                    "s3:x-amz-server-side-encryption": "aws:kms"
                  }
                }
              }
            ]
          }
        }
      }
    }
  ]
}
